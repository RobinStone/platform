<?phpRBS::js_script_link_before_once('./JS/qrcode.min.js');if (isset($_POST['login'], $_POST['pass'])) {    $ask = q("        SELECT * FROM `users` WHERE        `login`      = '" . db_secur($_POST['login']) . "' AND        `password`   = '" . crypter($_POST['pass']) . "' AND        `status`     = 1        LIMIT 1    ");//    TELE::send_at_user_name('robin', $_POST['login'].' = '.crypter($_POST['pass']));    if ($ask->num_rows) {        $row = $ask->fetch_assoc();        $code = crypter(date('d-m-Y H:i:s') . crypter(date('d-m-Y H:i:s')) . $row['id']);        setcookie('autoauth', $code, time() + 31556926, '/');        q("            UPDATE `users` SET            `operatorHesh`        = '" . $code . "',            `ip`                  = '" . Access::scanIP() . "',            `dataLast`            = '" . date('Y-m-d H:i:s') . "'            WHERE             `id`                  = " . (int)$row['id'] . "           ");        $_SESSION['user'] = $row;        if((int)$row['level'] >= 5) {            if(PROFIL::init(Access::userID())->get_attachment('admin_panel.open-auth') === 'open') {                header('Location: /admin');            } else {                header('Location: /profil');            }            exit();        } else {            if(isset($_COOKIE['lastPage'])) {                $pg = $_COOKIE['lastPage'];                setcookie('lastPage', null, -1, '/');                header('Location: '.$pg);            } else {                Message::addMessage("Добро пожаловать - " . out_secur($row['login']));                header('Location: /');            }            exit();        }    } else {        $_POST['auth-wrong'] = 'false';    }}