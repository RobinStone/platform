<?phpclass WORKTIME {    public static function set_work_time_in_day(string $code_string, int $day_num_1_7, string $time_from='0800', string $time_to='1600'): string {        $all = self::to_array($code_string);        $arr = ['', 'Пн','Вт','Ср','Чт','Пт','Сб','Вс'];        if($day_num_1_7 > 7 || $day_num_1_7 < 1) {            $day_num_1_7 = 1;            Message::addError('Не верно задан номен дня недели.');        }        $day = $arr[$day_num_1_7];        if($time_from === '' || $time_to === '') {            $all[$day]['FROM'] = '----';            $all[$day]['TO'] = '----';            $all[$day]['TYPE'] = '-';        } else {            $all[$day]['FROM'] = $time_from;            $all[$day]['TO'] = $time_to;            $all[$day]['TYPE'] = '+';        }        return self::arr_to_code($all);    }    public static function create_holiday(string $code_string, int $day_num_1_7): string {        $all = self::to_array($code_string);        $arr = ['', 'Пн','Вт','Ср','Чт','Пт','Сб','Вс'];        if($day_num_1_7 > 7 || $day_num_1_7 < 1) {            $day_num_1_7 = 1;            Message::addError('Не верно задан номен дня недели.');        }        $day = $arr[$day_num_1_7];        $all[$day]['FROM'] = '----';        $all[$day]['TO'] = '----';        $all[$day]['TYPE'] = '-';        return self::arr_to_code($all);    }    public static function to_array(string $code_string): array {        $ans = [];        $arr = explode('|', $code_string);        if(count($arr) !== 7) {            Message::addError('В графике работ отмечено неправильное количество дней.');        }        foreach($arr as $v) {            $day = mb_substr($v, 0, 2);            $ans[$day] = [                'FROM'=>mb_substr($v, 2, 2).":".mb_substr($v, 4, 2),                'TO'=>mb_substr($v, 6, 2).":".mb_substr($v, 8, 2),            ];            if(mb_substr($v, 2, 8) === '--------') {                $ans[$day]['TYPE'] = '-';            } else {                $ans[$day]['TYPE'] = '+';            }        }        return $ans;    }    public static function arr_to_code($arr): string {        $ans = [];        foreach($arr as $k=>$v) {            if($v['TYPE'] === '+') {                $from = mb_substr($v['FROM'], 0, 2).mb_substr($v['FROM'], 3, 2);                $to = mb_substr($v['TO'], 0, 2).mb_substr($v['TO'], 3, 2);                $ans[] = $k.$from.$to;            } else {                $ans[] = $k."--------";            }        }        return implode('|', $ans);    }    public static function create($from_HHMM='0800', $to_HHMM='1600', $workdays='+++++--'): string {        $arr = ['Пн','Вт','Ср','Чт','Пт','Сб','Вс'];        $i=0;        foreach($arr as $k=>$v) {            if($workdays[$i] === '+') {                $arr[$k] = $v.$from_HHMM.$to_HHMM;            } else {                $arr[$k] = $v.'--------';            }            ++$i;        }        return implode('|', $arr);    }    public static function format(string $code_string): string {        $ans = [];        $arr_ = [];        $buff = "";        $day_from = 'Пн';        $buff_day = '';        $day_to = 'Вс';        $arr = self::to_array($code_string);        foreach($arr as $k=>$v) {            $arr_[$k] = $v['FROM']."-".$v['TO'];            if($buff === "") {                $buff = $arr_[$k];                $buff_day = $k;            } else {                if($buff !== $arr_[$k]) {                    if($day_from !== $k) {                        if($day_from === $buff_day) {                            $ans[] = "<span style='display: inline-block; padding-right: 5px'>в</span>".$buff_day." - ".$buff;                        } else {                            $ans[] = $day_from."-".$buff_day." ".$buff;                        }                    } else {                        $ans[] = $day_from." ".$arr_[$k];                    }                    $buff = $arr_[$k];                    $day_from = $k;                }                $buff_day = $k;            }            if($k === $day_to) {                $ans[] = $day_from."-".$k." ".$arr_[$k];            }            foreach($ans as $k=>$v) {                if(str_contains($v, '--:-----:--')) {                    $ans[$k] = "<span style='color: red'>".mb_substr($v, 0, stripos($v, '--')-5)." - выходной</span>";                }            }        }        return implode('<br>', $ans);    }}