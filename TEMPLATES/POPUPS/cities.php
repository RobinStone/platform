<?php$citys = SQL_ROWS_FIELD(q("SELECT id, name, region, shirota, dolgota FROM cities ORDER BY name ASC"), 'name');$flow = SORT::find_in_array_recursive($citys, $val);$row = $citys[$flow];?><style>    .form {    }    .form .sell {        background-color: rgba(0, 227, 81, 0.55);    }    .form #llist li {        padding: 1px 3px;        cursor: pointer;    }    .form #llist li:hover {        outline: 1px solid #1fbcff;    }    .form #llist li:active {        transform: scale(0.95);    }    .form input {        margin: 0;        flex-grow: 2;        padding: 5px;        border: 1px solid #4A55684D;        outline: none;        border-radius: 5px;    }</style><div class="form flex gap-5 column">    <h1 style="padding-right: 60px"><?=$flow?></h1>    <h3>Начните вводить название города:</h3>    <input oninput="change_list(this)" list="list" type="text">    <ul id="llist"></ul></div><script>    setTimeout(function() {        $('input[list]').focus();    }, 20);    arr__ = <?=json_encode($citys, JSON_UNESCAPED_UNICODE);?>;    llist__ = $('#llist');    arr__ = Object.values(arr__);    $(document).on('click', 'li', function(e) {        let obj = this;        $('input[list]').val($(obj).text());        set_new_param_for_shop(<?=$id_shop?>, 'city', $(obj).attr('data-id'));        close_popup('cities');    });    if(typeof action_123 === 'undefined') {        action_123 = true;        $(document).on('keydown', 'input[list]', function (e) {            switch (e.keyCode) {                case 40:                    count__ = $('#llist li').length;                    index__ = $('#llist li.sell').index();                    ++index__;                    if (index__ >= count__) {                        index__ = 0;                    }                    $('.sell').removeClass('sell');                    $('#llist li:nth-child(' + (index__ + 1) + ')').addClass('sell');                    e.preventDefault();                    break;                case 38:                    count__ = $('#llist li').length;                    index__ = $('#llist li.sell').index();                    --index__;                    if (index__ < 0) {                        index__ = count__ - 1;                    }                    $('.sell').removeClass('sell');                    $('#llist li:nth-child(' + (index__ + 1) + ')').addClass('sell');                    e.preventDefault();                    break;                case 13:                    $('input[list]').val($('li.sell').text());                    set_new_param_for_shop(<?=$id_shop?>, 'city', $('li.sell').attr('data-id'));                    close_popup('cities');                    e.preventDefault();                    break;            }        })        function change_list(obj) {            llist__.empty();            let max = 15;            let i = 0;            let cur = true;            arr__.forEach(function (item) {                if (item.name.toLowerCase().includes(obj.value.toLowerCase())) {                    if (++i > max) {                        return true;                    }                    if (cur) {                        llist__.append('<li data-id="' + item.id + '" class="sell">' + item.name + '</li>');                        cur = false;                    } else {                        llist__.append('<li data-id="' + item.id + '">' + item.name + '</li>');                    }                }            });        }    }</script>