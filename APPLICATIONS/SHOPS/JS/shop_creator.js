upload_files = [];$(document).on('change', '#file-input-shop', function(e) {    const reader = new FileReader();    reader.onload = function(event) {        const image = new Image();        image.src = event.target.result;        let btn = $('<button onclick="$(this).remove(); return false" class="img-btn" title="Удалить изображение"></button>');        $(btn).append(image);        $('.logo-shop').append(btn);        upload_files.push(event.target.result);    }    reader.readAsDataURL(this.files[0]);});function create_new_shop() {    if($('.logo-shop .img-btn').length > 0) {        upload_shop_img($('.logo-shop .img-btn img'), translit($('input[data-name="name"]').val())+'_logo.jpg', function(res) {            console.log(res);            if(res.status === 'ok') {                create_shop_from_form(res.sys_name);            }        });    } else {        create_shop_from_form();    }}function create_shop_from_form(img_sys_name='') {    let arr = {        logo: img_sys_name,        name_shop: $('input[data-name="name"]').val(),        type_shop: $('select[data-name="type-shop"]').val(),        city: $('select[data-name="city"]').find('option[value="'+$('select[data-name="city"]').val()+'"]').attr('data-id'),        address: $('input[data-name="address"]').val(),        descr: $('textarea[data-name="descr"]').val(),    };    console.dir(arr);    SENDER_APP('new_shop', arr, function(mess) {        mess = JSON.parse(mess);        if(mess.status === 'ok') {            say('Магазин успешно создан!');            apps.app_update('SHOPS');            $('.product-creator').closest('.window').remove();        } else {            error_executing(mess);            apps.app_update('SHOPS');        }    });}